<html>
    <head>
        <title>Radice Christmas Harmony</title>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="style.css">
        <link rel="icon" type="image/png" href="logo.png">  
    </head>
    <body>
        <div id="toast"></div>
        <div class="popup" style="display: block;" id="popup">
            <h3>Imposta la tua nuova password</h3>
            <form id="form">
                <input type="password" id="Password1" placeholder="Inserisci la nuova email" required>
                <input type="password" id="Password2" placeholder="Inserisci nuovamente la password" required>
                <button type="submit">Imposta</button>
            </form>
        </div>
        <div class="popup" id="popupInfo">
            <p style="color: #FFD700; font-size: 28px;">Password aggiornata con successo! Clicca <a href="https://iragazzidelradice.it/radicechristmasharmony" style="color:#FFD700;">qui</a> per tornare al sito per effettuare il login.</p>
        </div>
    </body>
    <script>
        function createSnowflakes(count){ for(let i=0;i<count;i++){ const s=document.createElement('div'); s.classList.add('snowflake'); s.style.left=Math.random()*window.innerWidth+'px'; s.style.fontSize=(Math.random()*10+10)+'px'; s.style.animationDuration=(Math.random()*5+5)+'s'; s.textContent='â„'; document.body.appendChild(s);} }
        function resetSnowflakes(count){ document.querySelectorAll('.snowflake').forEach(el=>el.remove()); createSnowflakes(count);}
        createSnowflakes(100);
        if(window.innerWidth>=768){ window.addEventListener('resize', ()=>{ resetSnowflakes(100); }); }

        function showToast(msg, type = 'info', duration = 3500) {
            const toast = document.getElementById('toast');
            toast.textContent = msg;
            toast.className = `show ${type}`;

            setTimeout(() => {
                toast.className = '';
            }, duration);
            }
        const popup=document.getElementById("popup");
        const popupInfo=document.getElementById("popupInfo");
        const form=document.getElementById("form");
        form.addEventListener('submit',async(e)=>{
            e.preventDefault();

            const password1=document.getElementById("Password1").value;
            const password2=document.getElementById("Password2").value;
            if(password1!==password2){
                showToast("Password non coicidono","info");
                return;
            }
            try{
                const formdata= new FormData();
                formdata.append("password1",password1);
                formdata.append("password2",password2);
                const result=await fetch("recovery_password.php",{
                    method: 'POST',
                    body:formdata
                });
                const res= await result.text();
                if(res==="ok"){
                    popup.style.display="none";
                    popupInfo.style.display="block";
                }else{
                    showToast(res,"info");
                }
                }catch(err){

                }
           
        });
    </script>
</html>